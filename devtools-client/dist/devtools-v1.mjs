var l="MUTE-8-DEVTOOLS",T=()=>localStorage.getItem(l),x=e=>localStorage.setItem(l,e),g=()=>localStorage.removeItem(l),w=async()=>{let e=await(await fetch("http://localhost:4040/devtools-v1.mjs")).text();x(e);},j=async e=>{if(!document.getElementById(l))return new Promise((i,t)=>{if(!(!document||!window)){var o=document.createElement("script");o.id=l,o.type="module",o.innerText=e,document.head.appendChild(o),setTimeout(i,10);}})},m=T();m&&(await j(m),w());var c=()=>{},C=JSON.stringify,D=JSON.parse,h=window,U=document,W=(e,i)=>{let t=i??{width:600,height:400},o=h.screenLeft!=null?h.screenLeft:screen.left,n=h.screenTop!=null?h.screenTop:screen.top,r=h.innerWidth,s=h.innerHeight,a=U.documentElement,b=r||(a.clientWidth?a.clientWidth:screen.width),A=s||(a.clientHeight?a.clientHeight:screen.height),f=o+(t.xMove??0),y=n+(t.yMove??0);(t.centered??!0)&&(f+=b/2-t.width/2,y+=A/2-t.height/2);let B=t.target??"_blank",d=h.open(e,B,`width=${t.width}, height=${t.height} top=${y}, left=${f}, ${t.options??"resize=yes"}`);return d!=null&&d.focus&&d.focus(),d},E=e=>new URL(e).origin,$=(e,i)=>{if(e.origin!=i)throw new Error(`Invalid message origin: ${e.origin}, allowed: ${i}`)},L=(e,i,t)=>{h.addEventListener("message",o=>{$(o,i);let n=D(o.data);n&&n.i===e&&t(o.source,n);},!1);},I=(e,i,t,o,n)=>{let r={i:t,j:n,type:o};e?.postMessage(C(r),i);},O=class{constructor(e,i="1",t){this.id=i,this.origin=E(e),setTimeout(()=>{this.child||(this.child=W(e,t));},250),L(this.id,this.origin,(o,n)=>{var r,s,a;n.type==="msg"&&((r=this.onMessage)==null||r.call(this,D(n.j))),n.type==="child-open"&&((s=this.onChildOpen)==null||s.call(this)),o&&this.child==null&&n.type==="ping"&&(this.child=o,(a=this.onChildAttach)==null||a.call(this),I(this.child,this.origin,i,"host-attach",""));}),setInterval(()=>{var o;if(this.child&&this.child.closed){(o=this.onChildClose)==null||o.call(this),this.child=null;return}},100);}origin;child;onMessage=c;onChildOpen=c;onChildAttach=c;onChildClose=c;isOpen(){return !!this.child&&this.child.closed==!1}post(e){I(this.child,this.origin,this.id,"msg",C(e));}};var p=e=>{for(let i of Object.keys(e)){let t=e[i];t&&typeof t=="object"&&p(t);}return Object.freeze(e)},z={logger:{logChange:!1,logInit:!0},deepFreaze:!0},P=()=>new Date().getTime(),S=e=>localStorage.setItem("dev-tools-opne",e),J=()=>localStorage.getItem("dev-tools-opne"),u=class{enable=()=>{};disable=()=>g();Mute8DevToolsUIUrl="http://localhost:4030";sotrageRegistry=new Map;dialogHost;payloadBuffer=[];constructor(){let i=this;document.addEventListener("keydown",function(t){t.ctrlKey&&t.shiftKey&&t.code==="Digit8"&&(i.openDevTools(),t.preventDefault());});}register(i,t=z){return o=>{let n=s=>this.setStateInit(i,s),r=(s,a)=>{this.setStateChanged(i,s,a);};return this.sotrageRegistry.set(i,{label:i,proxy:o,onInit:n,onChange:r}),{BInit:s=>(n(s),t.logger.logInit&&console.table({[`${i}-init`]:s}),t.deepFreaze?p(s):s),BUpdate:s=>t.deepFreaze?p(s):s,AChange:(s,a)=>{r(s,a),t.logger.logChange&&console.table({[`${i}-old`]:s,[`${i}-new`]:a});}}}}openDevTools(){if(this.dialogHost&&this.dialogHost.isOpen()){this.dialogHost.child?.focus();return}this.dialogHost=new O(this.Mute8DevToolsUIUrl,"devtools",{height:550,width:800}),this.dialogHost.onMessage=this.handleMessage.bind(this),this.dialogHost.onChildOpen=this.sentInitData.bind(this),this.dialogHost.onChildAttach=this.sentInitData.bind(this),this.dialogHost.onChildClose=()=>S("closed");}postPayload(i){this.dialogHost?.post(i),this.payloadBuffer=this.payloadBuffer.concat(...i);}setStateInit(i,t){this.postPayload([{"storage-state-init":{storageLabel:i,state:t,time:P()}}]);}setStateChanged(i,t,o){this.postPayload([{"storage-state-changed":{storageLabel:i,oldState:t,newState:o,time:P()}}]);}sentInitData(){S("open");let t=Array.from(this.sotrageRegistry.entries()).map(([o,n])=>({label:o}));this.dialogHost.post([{init:{}},{"storage-definitions":t},...this.payloadBuffer]);}handleMessage(i){for(let t of i)t["host-command"]&&t["host-command"]==="refresh-host"&&window.location.reload();}};(()=>{let e=new u;window[l]=e,J()=="open"&&e.openDevTools();})();
