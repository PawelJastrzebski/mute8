var l="MUTE-8-DEVTOOLS",T=()=>localStorage.getItem(l),x=t=>localStorage.setItem(l,t),g=()=>localStorage.removeItem(l),w=async()=>{let t=await(await fetch("http://localhost:4040/devtools-v1.mjs")).text();x(t);},j=async t=>{if(!document.getElementById(l))return new Promise((i,e)=>{if(!(!document||!window)){var o=document.createElement("script");o.id=l,o.type="module",o.innerText=t,document.head.appendChild(o),setTimeout(i,10);}})},m=T();m&&(await j(m),w());var c=()=>{},C=JSON.stringify,D=JSON.parse,U=t=>{try{return D(t)}catch{return null}},h=window,W=document,E=(t,i)=>{let e=i??{width:600,height:400},o=h.screenLeft!=null?h.screenLeft:screen.left,n=h.screenTop!=null?h.screenTop:screen.top,r=h.innerWidth,s=h.innerHeight,a=W.documentElement,b=r||(a.clientWidth?a.clientWidth:screen.width),A=s||(a.clientHeight?a.clientHeight:screen.height),f=o+(e.xMove??0),y=n+(e.yMove??0);(e.centered??!0)&&(f+=b/2-e.width/2,y+=A/2-e.height/2);let B=e.target??"_blank",d=h.open(t,B,`width=${e.width}, height=${e.height} top=${y}, left=${f}, ${e.options??"resize=yes"}`);return d!=null&&d.focus&&d.focus(),d},$=t=>new URL(t).origin,L=(t,i)=>{if(t.origin!=i)throw new Error(`Invalid message origin: ${t.origin}, allowed: ${i}`)},z=(t,i,e)=>{h.addEventListener("message",o=>{let n=U(o.data);n&&n.type&&n.i===t&&(L(o,i),e(o.source,n));},!1);},I=(t,i,e,o,n)=>{let r={i:e,j:n,type:o};t?.postMessage(C(r),i);},O=class{constructor(t,i="1",e){this.id=i,this.origin=$(t),setTimeout(()=>{this.child||(this.child=E(t,e));},250),z(this.id,this.origin,(o,n)=>{var r,s,a;n.type==="msg"&&((r=this.onMessage)==null||r.call(this,D(n.j))),n.type==="child-open"&&((s=this.onChildOpen)==null||s.call(this)),o&&this.child==null&&n.type==="ping"&&(this.child=o,(a=this.onChildAttach)==null||a.call(this),I(this.child,this.origin,i,"host-attach",""));}),setInterval(()=>{var o;if(this.child&&this.child.closed){(o=this.onChildClose)==null||o.call(this),this.child=null;return}},100);}origin;child;onMessage=c;onChildOpen=c;onChildAttach=c;onChildClose=c;isOpen(){return !!this.child&&this.child.closed==!1}post(t){I(this.child,this.origin,this.id,"msg",C(t));}};var p=t=>{for(let i of Object.keys(t)){let e=t[i];e&&typeof e=="object"&&p(e);}return Object.freeze(t)},J={logger:{logChange:!1,logInit:!0},deepFreaze:!0},P=()=>new Date().getTime(),S=t=>localStorage.setItem("dev-tools-opne",t),N=()=>localStorage.getItem("dev-tools-opne"),u=class{enable=()=>{};disable=()=>g();Mute8DevToolsUIUrl="http://localhost:4030";sotrageRegistry=new Map;dialogHost;payloadBuffer=[];constructor(){let i=this;document.addEventListener("keydown",function(e){e.ctrlKey&&e.shiftKey&&e.code==="Digit8"&&(i.openDevTools(),e.preventDefault());});}register(i,e=J){return o=>{let n=s=>this.setStateInit(i,s),r=(s,a)=>{this.setStateChanged(i,s,a);};return this.sotrageRegistry.set(i,{label:i,proxy:o,onInit:n,onChange:r}),{BInit:s=>(n(s),e.logger.logInit&&console.table({[`${i}-init`]:s}),e.deepFreaze?p(s):s),BUpdate:s=>e.deepFreaze?p(s):s,AChange:(s,a)=>{r(s,a),e.logger.logChange&&console.table({[`${i}-old`]:s,[`${i}-new`]:a});}}}}openDevTools(){if(this.dialogHost&&this.dialogHost.isOpen()){this.dialogHost.child?.focus();return}this.dialogHost=new O(this.Mute8DevToolsUIUrl,"devtools",{height:550,width:800}),this.dialogHost.onMessage=this.handleMessage.bind(this),this.dialogHost.onChildOpen=this.sentInitData.bind(this),this.dialogHost.onChildAttach=this.sentInitData.bind(this),this.dialogHost.onChildClose=()=>S("closed");}postPayload(i){this.dialogHost?.post(i),this.payloadBuffer=this.payloadBuffer.concat(...i);}setStateInit(i,e){this.postPayload([{"storage-state-init":{storageLabel:i,state:e,time:P()}}]);}setStateChanged(i,e,o){this.postPayload([{"storage-state-changed":{storageLabel:i,oldState:e,newState:o,time:P()}}]);}sentInitData(){S("open");let e=Array.from(this.sotrageRegistry.entries()).map(([o,n])=>({label:o}));this.dialogHost.post([{init:{}},{"storage-definitions":e},...this.payloadBuffer]);}handleMessage(i){for(let e of i)e["host-command"]&&e["host-command"]==="refresh-host"&&window.location.reload();}};(()=>{let t=new u;window[l]=t,N()=="open"&&t.openDevTools();})();
