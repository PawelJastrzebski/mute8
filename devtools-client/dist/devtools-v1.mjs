var l="MUTE-8-DEVTOOLS",m=()=>localStorage.getItem(l),H=t=>localStorage.setItem(l,t),g=()=>localStorage.removeItem(l),T=async()=>{let t=await(await fetch("http://localhost:4040/devtools-v1.mjs")).text();H(t);},M=async t=>{if(!document.getElementById(l))return new Promise((i,e)=>{if(!(!document||!window)){var o=document.createElement("script");o.id=l,o.type="module",o.innerText=t,document.head.appendChild(o),setTimeout(i,10);}})},v=m();v&&(await M(v),T());var c=()=>{},I=JSON.stringify,C=JSON.parse,x=t=>{try{return C(t)}catch{return null}},h=window,j=document,U=(t,i)=>{let e=i??{width:600,height:400},o=h.screenLeft!=null?h.screenLeft:screen.left,n=h.screenTop!=null?h.screenTop:screen.top,a=h.innerWidth,s=h.innerHeight,r=j.documentElement,S=a||(r.clientWidth?r.clientWidth:screen.width),b=s||(r.clientHeight?r.clientHeight:screen.height),f=o+(e.xMove??0),y=n+(e.yMove??0);(e.centered??!0)&&(f+=S/2-e.width/2,y+=b/2-e.height/2);let A=e.target??"_blank",d=h.open(t,A,`width=${e.width}, height=${e.height} top=${y}, left=${f}, ${e.options??"resize=yes"}`);return d!=null&&d.focus&&d.focus(),d},W=t=>new URL(t).origin,E=(t,i)=>{if(t.origin!=i)throw new Error(`Invalid message origin: ${t.origin}, allowed: ${i}`)},$=(t,i,e)=>{h.addEventListener("message",o=>{let n=x(o.data);n&&n.type&&n.i===t&&(E(o,i),e(o.source,n));},!1);},w=(t,i,e,o,n)=>{let a={i:e,j:n,type:o};t?.postMessage(I(a),i);},D=class{constructor(t,i="1",e){this.id=i,this.origin=W(t),setTimeout(()=>{this.child||(this.child=U(t,e));},250),$(this.id,this.origin,(o,n)=>{var a,s,r;n.type==="msg"&&((a=this.onMessage)==null||a.call(this,C(n.j))),n.type==="child-open"&&((s=this.onChildOpen)==null||s.call(this)),o&&this.child==null&&n.type==="ping"&&(this.child=o,(r=this.onChildAttach)==null||r.call(this),w(this.child,this.origin,i,"host-attach",""));}),setInterval(()=>{var o;if(this.child&&this.child.closed){(o=this.onChildClose)==null||o.call(this),this.child=null;return}},100);}origin;child;onMessage=c;onChildOpen=c;onChildAttach=c;onChildClose=c;isOpen(){return !!this.child&&this.child.closed==!1}post(t){w(this.child,this.origin,this.id,"msg",I(t));}};var p=t=>{for(let i of Object.keys(t)){let e=t[i];e&&typeof e=="object"&&p(e);}return Object.freeze(t)},L={logger:{logChange:!1,logInit:!0},deepFreaze:!0},O=()=>new Date().getTime(),P=t=>localStorage.setItem("dev-tools-opne",t),R=()=>localStorage.getItem("dev-tools-opne"),u=class{enable=()=>{};disable=()=>g();Mute8DevToolsUIUrl="http://localhost:4030";sotrageRegistry=new Map;dialogHost;payloadBuffer=[];constructor(){let i=this;document.addEventListener("keydown",function(e){e.ctrlKey&&e.shiftKey&&e.code==="Digit8"&&(i.openDevTools(),e.preventDefault());});}register(i,e=L){return o=>{let n=s=>this.setStateInit(i,s),a=(s,r)=>{this.setStateChanged(i,s,r);};return this.sotrageRegistry.set(i,{label:i,proxy:o,onInit:n,onChange:a}),{BInit:s=>(n(s),e.logger.logInit&&console.table({[`${i}-init`]:s}),e.deepFreaze?p(s):s),BUpdate:s=>e.deepFreaze?p(s):s,AChange:(s,r)=>{a(s,r),e.logger.logChange&&console.table({[`${i}-old`]:s,[`${i}-new`]:r});}}}}openDevTools(){if(this.dialogHost&&this.dialogHost.isOpen()){this.dialogHost.child?.focus();return}this.dialogHost=new D(this.Mute8DevToolsUIUrl,"devtools",{height:550,width:800}),this.dialogHost.onMessage=this.handleMessage.bind(this),this.dialogHost.onChildOpen=this.sentInitData.bind(this),this.dialogHost.onChildAttach=this.sentInitData.bind(this),this.dialogHost.onChildClose=()=>P("closed");}postPayload(i){this.dialogHost?.post(i),this.payloadBuffer=this.payloadBuffer.concat(...i);}setStateInit(i,e){this.postPayload([{stateInit:{storageLabel:i,state:e,time:O()}}]);}setStateChanged(i,e,o){this.postPayload([{stateChanged:{storageLabel:i,oldState:e,newState:o,time:O()}}]);}sentInitData(){P("open");let e=Array.from(this.sotrageRegistry.entries()).map(([o,n])=>({label:o}));this.dialogHost.post([{init:{}},{storageDefinitions:e},...this.payloadBuffer]);}handleMessage(i){for(let e of i)e.hostCommand==="refresh-host"&&window.location.reload();}};(()=>{let t=new u;window[l]=t,R()=="open"&&t.openDevTools();})();
