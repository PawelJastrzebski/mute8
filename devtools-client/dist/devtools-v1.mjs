var l="MUTE-8-DEVTOOLS",T=()=>localStorage.getItem(l),b=i=>localStorage.setItem(l,i),p=()=>localStorage.removeItem(l),w=async()=>{let i=await(await fetch("http://localhost:4040/devtools-v1.mjs")).text();b(i);},M=async i=>{if(!document.getElementById(l))return new Promise((t,e)=>{if(!(!document||!window)){var s=document.createElement("script");s.id=l,s.type="module",s.innerText=i,document.head.appendChild(s),setTimeout(t,30);}})},m=T();m&&(await M(m),w());var g=()=>{},I=JSON.stringify,C=JSON.parse,x=i=>{try{return C(i)}catch{return null}},h=window,j=document,U=(i,t)=>{let e=t??{width:600,height:400},s=h.screenLeft!=null?h.screenLeft:screen.left,n=h.screenTop!=null?h.screenTop:screen.top,r=h.innerWidth,d=h.innerHeight,o=j.documentElement,a=r||(o.clientWidth?o.clientWidth:screen.width),A=d||(o.clientHeight?o.clientHeight:screen.height),f=s+(e.xMove??0),y=n+(e.yMove??0);(e.centered??!0)&&(f+=a/2-e.width/2,y+=A/2-e.height/2);let B=e.target??"_blank",c=h.open(i,B,`width=${e.width}, height=${e.height} top=${y}, left=${f}, ${e.options??"resize=yes"}`);return c!=null&&c.focus&&c.focus(),c},W=i=>new URL(i).origin,E=(i,t)=>{if(i.origin!=t)throw new Error(`Invalid message origin: ${i.origin}, allowed: ${t}`)},$=(i,t,e)=>{h.addEventListener("message",s=>{let n=x(s.data);n&&n.type&&n.i===i&&(E(s,t),e(s.source,n));},!1);},O=(i,t,e,s,n)=>{let r={i:e,j:n,type:s};i?.postMessage(I(r),t);},D=class{constructor(i,t="1",e){this.id=t,this.origin=W(i),setTimeout(()=>{this.child||(this.child=U(i,e));},250),$(this.id,this.origin,(s,n)=>{var r,d,o;n.type==="msg"&&((r=this.onMessage)==null||r.call(this,C(n.j))),n.type==="child-open"&&((d=this.onChildOpen)==null||d.call(this)),s&&this.child==null&&n.type==="ping"&&(this.child=s,(o=this.onChildAttach)==null||o.call(this),O(this.child,this.origin,t,"host-attach",""));}),setInterval(()=>{var s;if(this.child&&this.child.closed){(s=this.onChildClose)==null||s.call(this),this.child=null;return}},100);}origin;child;onMessage=g;onChildOpen=g;onChildAttach=g;onChildClose=g;isOpen(){return !!this.child&&this.child.closed==!1}post(i){O(this.child,this.origin,this.id,"msg",I(i));}};var u=i=>{for(let t of Object.keys(i)){let e=i[t];e&&typeof e=="object"&&u(e);}return Object.freeze(i)},L={logger:{logChange:!1,logInit:!0},deepFreaze:!0},P=()=>new Date().getTime(),S=i=>localStorage.setItem("dev-tools-opne",i),R=()=>localStorage.getItem("dev-tools-opne"),v=class{enable=()=>{};disable=()=>p();Mute8DevToolsUIUrl="http://localhost:4030";sotrageRegistry=new Map;dialogHost;payloadBuffer=[];stateOverrides={};constructor(){let t=this;document.addEventListener("keydown",function(e){e.ctrlKey&&e.shiftKey&&e.code==="Digit8"&&(t.openDevTools(),e.preventDefault());});}register(t,e=L){let s=this;return n=>{let r=o=>s.setStateInit(t,o),d=(o,a)=>{s.setStateChanged(t,o,a);};return this.sotrageRegistry.set(t,{label:t,proxy:n,onInit:r,onChange:d}),{BInit:o=>(r(o),e.logger.logInit&&console.table({[`${t}-init`]:o}),e.deepFreaze?u(o):o),BUpdate:o=>{let a=s.stateOverrides[t];return a&&(o=a.state),e.deepFreaze&&(o=u(o)),o},AChange:(o,a)=>{d(o,a),e.logger.logChange&&console.table({[`${t}-old`]:o,[`${t}-new`]:a});}}}}openDevTools(){if(this.dialogHost&&this.dialogHost.isOpen()){this.dialogHost.child?.focus();return}this.dialogHost=new D(this.Mute8DevToolsUIUrl,"devtools",{height:550,width:800}),this.dialogHost.onMessage=this.handleMessage.bind(this),this.dialogHost.onChildOpen=this.sentInitData.bind(this),this.dialogHost.onChildAttach=this.sentInitData.bind(this),this.dialogHost.onChildClose=()=>S("closed");}postPayload(t){this.dialogHost?.post(t),this.payloadBuffer=this.payloadBuffer.concat(...t);}setStateInit(t,e){this.stateOverrides[t]||this.postPayload([{stateInit:{storageLabel:t,state:e,time:P()}}]);}setStateChanged(t,e,s){this.stateOverrides[t]||this.postPayload([{stateChanged:{storageLabel:t,oldState:e,newState:s,time:P()}}]);}sentInitData(){S("open");let e=Array.from(this.sotrageRegistry.entries()).map(([s,n])=>({label:s}));this.dialogHost.post([{init:{}},{storageDefinitions:e},{stateOverrides:this.stateOverrides},...this.payloadBuffer]);}handleMessage(t){for(let e of t)if(e.hostCommand==="refresh-host"&&window.location.reload(),e.stateOverrides){this.stateOverrides=e.stateOverrides??{};for(let[s,n]of this.sotrageRegistry.entries()){let r=this.stateOverrides[s];r&&(n.proxy.mut=r);}}}};(()=>{let i=window[l]=new v;R()=="open"&&i.openDevTools();})();
